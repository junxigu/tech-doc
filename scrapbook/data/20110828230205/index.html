<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">






<link rel="stylesheet" type="text/css" href="index.css" media="all">
</head>
<body><div id="bd_snap">
    <div id="bd_snap_head">
        <a href="http://www.baidu.com/" id="bd_snap_logo" title="到百度首页"></a>
        <div id="bd_snap_search">
        <form action="http://www.baidu.com/s"><input name="cl" value="3" type="hidden"><input value="" name="wd" id="bd_snap_kw" maxlength="100"><span id="bd_snap_btn_wr"><input id="bd_snap_su" value="百度一下" class="bd_snap_btn" onmousedown="this.className='bd_snap_btn bd_snap_btn_h'" type="submit"></span></form>
    	</div>
    </div>
    <div id="bd_snap_txt">您查询的关键词是：<span><a style="color: black; background-color: rgb(255, 255, 102); padding: 0pt 3px; font-weight: bold;" href="http://cache.baidu.com/c?m=9d78d513d98714fc18b0cb25524582310e54f13567978744398fd71f84642a1e1438b7e6677d4752c7823c390ef50f1aa8e737012a1e7aec8cc8ff1a8ee0c46f388850652d439b03508d42f3951d61963dc004b4fa04bcfca76d8efed3d9d90751cf53537a8ba481500244c06af21761e1f5ca5f15284afcb26e&amp;p=882a90469c9f12a05ebbd63d1e5d&amp;user=baidu&amp;fm=sc&amp;query=vgaromimage+directive++malformed&amp;qid=fcc186400997e456&amp;p1=2#baidusnap0">vgaromimage</a><a style="color: black; background-color: rgb(160, 255, 255); padding: 0pt 3px; font-weight: bold;" href="http://cache.baidu.com/c?m=9d78d513d98714fc18b0cb25524582310e54f13567978744398fd71f84642a1e1438b7e6677d4752c7823c390ef50f1aa8e737012a1e7aec8cc8ff1a8ee0c46f388850652d439b03508d42f3951d61963dc004b4fa04bcfca76d8efed3d9d90751cf53537a8ba481500244c06af21761e1f5ca5f15284afcb26e&amp;p=882a90469c9f12a05ebbd63d1e5d&amp;user=baidu&amp;fm=sc&amp;query=vgaromimage+directive++malformed&amp;qid=fcc186400997e456&amp;p1=2#baidusnap1">directive</a><a style="color: black; background-color: rgb(153, 255, 153); padding: 0pt 3px; font-weight: bold;" href="http://cache.baidu.com/c?m=9d78d513d98714fc18b0cb25524582310e54f13567978744398fd71f84642a1e1438b7e6677d4752c7823c390ef50f1aa8e737012a1e7aec8cc8ff1a8ee0c46f388850652d439b03508d42f3951d61963dc004b4fa04bcfca76d8efed3d9d90751cf53537a8ba481500244c06af21761e1f5ca5f15284afcb26e&amp;p=882a90469c9f12a05ebbd63d1e5d&amp;user=baidu&amp;fm=sc&amp;query=vgaromimage+directive++malformed&amp;qid=fcc186400997e456&amp;p1=2#baidusnap2">malformed</a></span> 。如果打开速度慢，可以尝试<a href="http://cache.baidu.com/c?m=9d78d513d98714fc18b0cb25524582310e54f13567978744398fd71f84642a1e1438b7e6677d4752c7823c390ef50f1aa8e737012a1e7aec8cc8ff1a8ee0c46f388850652d439b03508d42f3951d61963dc004b4fa04bcfca76d8efed3d9d90751cf53537a8ba481500244c06af21761e1f5ca5f15284afcb26e&amp;p=882a90469c9f12a05ebbd63d1e5d&amp;user=baidu&amp;fm=sc&amp;query=vgaromimage+directive++malformed&amp;qid=fcc186400997e456&amp;p1=2&amp;fast=y">快速版</a>；如果想保存快照，可以<a onclick="window.open('http://cang.baidu.com/do/add?it='+encodeURIComponent(document.title)+'&amp;iu='+encodeURIComponent(location.href)+'&amp;fr=ps#nw=1','_s','scrollbars=no,width=600,height=450,right=75,top=20,status=no,resizable=yes'); return false;" href="http://cang.baidu.com/do/add" target="_top">添加到搜藏</a>；如果想更新或删除快照，可以<a href="http://tousu.baidu.com/webmaster/add" target="">投诉快照</a>。</div>
    <div id="bd_snap_note">(百度和网页<a href="http://hi.baidu.com/pplinlive/blog/item/b384a072d29f880b8701b0aa.html">http://hi.baidu.com/pplinlive/blog/item/b384a072d29f880b8701b0aa.html</a>的作者无关，不对其内容负责。百度快照谨为网络故障时之索引，不代表被搜索网站的即时页面。)</div>
</div>
<div id="bd_snap_ln"></div>
<div style="position: relative;">
<!--STATUS OK-->



<title>终于实现了我的小操作系统_菲菲树林_百度空间      </title>
















<center>








<div class="userbar">
    <div id="nav">
        <a class="logo" href="http://hi.baidu.com/index.htm"><img src="logo.gif" alt="图片" border="0"></a>



        <div class="manage">
            <form action="https://passport.baidu.com/?login" method="post">
                用户名:<input value="" name="username" type="text">&nbsp;&nbsp; 
                密码:<input name="password" type="password"> 
                <input name="mem_pass" value="on" type="hidden">
                <input value="" style="width: 0pt; height: 0pt;" type="submit">
                <a href="#" class="loginlink" onclick="this.parentNode.submit(); return false;">登录</a>  
            </form> 
            <a href="http://hi.baidu.com/reg/new" class="reglink">注册</a>
        </div>

    </div>
</div>

 
 


		



<div id="main" align="left">

<!--[if IE]>

<![endif]-->

	<div id="header">

	<div class="lc"><div class="rc"></div></div>
<div class="tit"><a href="http://hi.baidu.com/pplinlive/home" class="titlink" title="菲菲树林的空间 http://hi.baidu.com/pplinlive">菲菲树林</a></div>
<div class="desc"></div>
<div id="tabline">&nbsp;</div>

	<div id="tab"><a href="http://hi.baidu.com/pplinlive/home">主页</a><a href="http://hi.baidu.com/pplinlive/blog" class="on">博客</a><a href="http://hi.baidu.com/pplinlive/album">相册</a><span>|</span><a href="http://hi.baidu.com/pplinlive/profile">个人档案</a>

	<span>|</span><a href="http://hi.baidu.com/pplinlive/friends">好友</a>


<span>|</span><a href="http://tieba.baidu.com/i/sys/jump?un=%B7%C6%B7%C6%CA%F7%C1%D6&amp;fr=spacebar" onclick="BdUtil.ns_trackerLink('m_20110330_spacebar','')" target="_top">i贴吧</a>


	</div>

</div>



<div class="stage">

<div class="stagepad">

<div style="width: 100%;">


<table class="modth" border="0" cellpadding="0" cellspacing="0" width="100%">

	<tbody><tr><td class="modtl" width="7">&nbsp;</td>

	<td class="modtc" nowrap="nowrap"><div class="modhead"><span class="modtit">查看文章</span></div></td>

	<td class="modtc" align="right" nowrap="nowrap"></td>

	<td class="modtr" width="7">&nbsp;</td>

	</tr></tbody></table>



<div id="m_blog" class="modbox" style="overflow-x: hidden;">

<div class="tit">

终于实现了我的小操作系统</div>

<div class="date">2011-05-08  21:50</div>




<table style="table-layout: fixed; width: 100%;"><tbody><tr><td><div id="blog_text" class="cnt"><p>早在大三的时候就很想自己动手写一个操作系统，于是乎也买了一本于渊的《自己动手写操作系统》，但是看到第一章就傻眼了，还要软盘一个，当时就想上哪去弄这个东西啊？再加上当时还真有些小忙，于是乎，写操作系统这件事情就这样耽搁了。前几天偶然间发现了于渊居然发布了《自己动手写操作系统》的第二版，于是从电驴上下下来看了看，第一章还是一样的需要软盘，不过这个时候我已经有了虚拟机的概念了，所以自认为可以再虚拟机中模拟软盘。于是接着往下看，在第二章就发现了Bochs这个虚拟机。哈哈，英雄所见相同啊！</p>
<p>&nbsp;</p>
<p>于是乎我就开始装bochs（版本是2.4,6），和NASM，环境是Windows 7。按照步骤一步步进行，可是运行bochs时会出现这个问题：</p>
<p>========================================================================<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bochs x86 Emulator 2.4.6<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Build from CVS snapshot, on February 22, 2011<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Compiled at Feb 22 2011, 19:57:47<br>========================================================================<br>00000000000i[&nbsp;&nbsp;&nbsp;&nbsp; ] reading configuration from bochsrc.bxrc<br>00000000000p[&nbsp;&nbsp;&nbsp;&nbsp; ] &gt;&gt;PANIC&lt;&lt; bochsrc.bxrc:10: <a name="baidusnap0"></a><b style="color: black; background-color: rgb(255, 255, 102);">vgaromimage</b> <a name="baidusnap1"></a><b style="color: black; background-color: rgb(160, 255, 255);">directive</b> <a name="baidusnap2"></a><b style="color: black; background-color: rgb(153, 255, 153);">malformed</b>.<br>00000000000e[CTRL ] notify called, but no bxevent_callback function is registere<br>d<br>========================================================================<br>Bochs is exiting with the following message:<br>[&nbsp;&nbsp;&nbsp;&nbsp; ] bochsrc.bxrc:10: <b style="color: black; background-color: rgb(255, 255, 102);">vgaromimage</b> <b style="color: black; background-color: rgb(160, 255, 255);">directive</b> <b style="color: black; background-color: rgb(153, 255, 153);">malformed</b>.<br>========================================================================<br>00000000000i[CTRL ] quit_sim called with exit code 1</p>
<p>后来我上网查了查，发现由于Bochs版本不断改进升级，若在这些新的Bochs版本下运行，则需要对相应的Bochs配置文件（*.bxrc）进行一点修改。主要修改有以下几处：<br><br>1. 修改romimage参数设置为（去掉最后逗号后面的address=信息）：<br>&nbsp; &nbsp;romimage: file=$BXSHARE/BIOS-bochs-latest<br><br>2. 修改<b style="color: black; background-color: rgb(255, 255, 102);">vgaromimage</b>参数设置为（添加了“file=”）：<br>&nbsp; &nbsp;<b style="color: black; background-color: rgb(255, 255, 102);">vgaromimage</b>: file = $BXSHARE/VGABIOS-lgpl-latest<br><br>3. 删除或注释掉以下几个过时的参数设置<br>&nbsp;&nbsp;#parport1: enable=0<br>&nbsp; &nbsp;#floppy_command_delay: 50000<br>&nbsp; &nbsp;#ips: 4000000</p>
<p>&nbsp;</p>
<p>哈哈，成功搞定，看到界面上出现红色的“Hello OS World！”，甚是开心啊！<br><br><br></p></div></td></tr></tbody></table>

<br>

<div class="opt">

<a href="http://hi.baidu.com/pplinlive/blog/category/%B2%D9%D7%F7%CF%B5%CD%B3" title="查看该分类中所有文章">类别：操作系统</a>

| <a href="#" onclick="addToShare(); return false;" target="_top"><img src="share_btn.gif" align="absbottom" border="0"></a>




	

	| <a title="将此文章添加到百度搜藏" href="http://cang.baidu.com/do/add" onclick="return addToFavor();" target="_top">添加到搜藏</a>

	
    | <a title="将此文章分享到i贴吧" href="#" onclick="addToiTieba(); return false;" target="_top">分享到i贴吧</a>

	| 浏览(<span id="result"></span>)

	| <a href="#send">评论</a>&nbsp;(0)







</div>



<div class="line">&nbsp;</div>







    


<div id="in_related_tmp"></div>


    













<div id="in_reader">
    <div class="tit">最近读者：</div>

</div>





<div class="line">&nbsp;</div>










<div id="in_comment">

    <a name="comment"></a>

    <div class="tit">网友评论：</div>

    <span id="userCommentList"></span>    

    <div id="page"></div>

</div>

<form action="http://hi.baidu.com/pplinlive/commit" id="blogCmtSubmitForm" name="blogCmtSubmitForm" method="post">
    <input name="bdstoken" value="" type="hidden">
    <input name="ct" value="8" type="hidden">
    <input name="cm" value="2" type="hidden">
    <input name="spBlogID" value="b384a072d29f880b8701b0aa" type="hidden">
    <input name="spBlogCmtID" value="" type="hidden">
    <input name="spRefURL" value="" type="hidden">
</form>






<div id="in_send">

<a name="send"></a>

<form name="form1" id="popFormSubmit" action="http://hi.baidu.com/pplinlive/commit" method="post" onsubmit="return checkcmtform()">

<input name="bdstoken" value="" type="hidden">

<input name="ct" value="8" type="hidden">

<input name="cm" value="1" type="hidden">

<input name="spBlogID" value="b384a072d29f880b8701b0aa" type="hidden">

<input name="spRefURL" id="spRefURL" type="hidden">



<div class="tit">发表评论：</div>

<table border="0" cellpadding="0" cellspacing="5" width="620">





<tbody><tr id="2_err" style="display: none;">

<td>&nbsp;</td>

<td><div class="error" id="2_err_con"></div></td>

</tr>



<tr>

<td class="f14" id="reTitle" valign="top">内　容：</td>

<td>
	<textarea name="spBlogCmtText" id="spBlogCmtText" style="width: 520px; height: 155px;" tabindex="3" onfocus="hidErr(3);" onclick="BdUtil.relogin(); return false;"></textarea>
</td>

</tr>

<tr id="3_err" style="display: none;">

<td>&nbsp;</td>

<td><div class="error" id="3_err_con"></div></td>

</tr>




<tr>

<td class="f14" valign="top">&nbsp;</td>

<td class="f14" valign="top"><input id="btn_ok" name="btn_ok" autocomplete="off" onclick="BdUtil.relogin(); return false;" value="发表评论" tabindex="5" type="submit">&nbsp;&nbsp;&nbsp;&nbsp;<a href="#" id="cancleReLink" onclick="canclereply(); return false;" style="display: none; font-size: 12px; color: rgb(102, 102, 102);">取消回复</a></td>

</tr>

</tbody></table>

</form>

</div>









<br>

</div>



<table border="0" cellpadding="0" cellspacing="0" height="8" width="100%">

<tbody><tr><td class="modbl" width="7">&nbsp;</td>

<td class="modbc">&nbsp;</td>

<td class="modbr" width="7">&nbsp;</td>

</tr></tbody></table>







</div>

</div>



</div>



</div>



<br><center><div id="ft">©2011 Baidu</div></center>


</center>

<ul id="blogCmtContentList" style="display: none;">

</ul>

<!--inc_getmsgnum.html-->

<iframe id="submitiframe" name="submitiframe" src="index_1.html" style="display: none;"></iframe>







			





	
	
















</div>



</body>
</html>
